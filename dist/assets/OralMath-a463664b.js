import{d as q,r as B,k as S,ct as k,e as D,A as c,af as F,cu as C,o as d,c as x,w as o,b as r,a as p,t as f,u as g,f as O,p as T,s as $,F as H,aT as b,E as U,cv as V,a3 as R,c8 as z,c9 as L,_ as A}from"./index-56ef5580.js";import{a as G,E as Q}from"./el-row-ecba2cf7.js";import{E as K}from"./el-card-cd202033.js";import{F as P}from"./FlipCounter-ce7eaaef.js";import{E as s,Q as X}from"./http-f85647fc.js";import{a as j}from"./settings-5434be94.js";const J={class:"question"},W=q({__name:"OralMath",setup(Y){const e=B({id:0,name:"",digital_num:2,max_digital:30,que_num:40,state:s.IDLE,exam_seconds:0,start_time:0,meta:[{title:"",answer:0,user_answer:"",mark:""}]}),h=S(!0),l=k();D(()=>{e.id=Number(l.query.id),e.name=String(l.query.name),e.exam_seconds=Number(l.query.exam_seconds),e.digital_num=Number(l.query.digital_num),e.max_digital=Number(l.query.max_digital),e.que_num=Number(l.query.q_num),e.state=s.ONGOING;var t=c.loadSettings();t&&(h.value=t.data[j.EXAM_TIME_BLINK].value),c.getOralMath(e.digital_num,e.max_digital,e.que_num).then(u=>{e.meta=[],u.data.forEach(n=>e.meta.push({title:n[0],answer:n[1],user_answer:"",mark:""})),e.start_time=Date.now()})}),F(()=>{e.state=s.FINISHED});const E=async()=>{e.state=s.FINISHED;var t=0,u=0;e.meta.forEach(m=>{var i=String(m.answer)==m.user_answer;m.mark=i?"âœ…":"âŒ",t+=i?1:0}),u=e.meta.length-t;var n=c.loadUserIdFromStorage(),a=new X;a.meta.note=`åŠ æ•°:${e.digital_num}ä¸ª, æœ€å¤§: ${e.max_digital}; ${t}/${e.meta.length}`,a.meta.user=n,a.meta.quiz=e.id,a.meta.abs_score=Math.round(t*100/e.meta.length),a.meta.rel_score=Math.round(t*100/e.meta.length),a.meta.use_minutes=Math.max(1,Math.round((Date.now()-e.start_time)/1e3/60)),await c.postQuizResult(a.meta),b.alert(`ã€å¾—åˆ†ã€‘<b>${a.meta.abs_score}</b>/100<br/>ã€è¯¦æƒ…ã€‘`+(t==e.meta.length?"æ­å–œæ‚¨è·å¾—æ»¡åˆ†<font size='5'>ğŸ’¯</font><br/>":`<b>${t}</b> âœ…, <b>${u}<b/> âŒ<br/>`)+`ã€ç”¨æ—¶ã€‘<b>${((Date.now()-e.start_time)/1e3/60).toFixed(2)}<b/>åˆ†é’Ÿ<br/>`,"è€ƒè¯•ç»“æœ",{type:t==e.meta.length?"success":"error",dangerouslyUseHTMLString:!0})},w=()=>{b.confirm("ç¡®å®šç»“æŸè€ƒè¯•å¹¶äº¤å·å—ï¼Ÿ","è¯·ç¡®è®¤",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then(()=>{E()})};return C((t,u,n)=>{if(e.state!=s.ONGOING){n();return}b.confirm("æ­£åœ¨è€ƒè¯•ä¸­ï¼Œç¦»å¼€é¡µé¢æ•°æ®å°†ä¼šä¸¢å¤±ï¼Œè€ƒè¯•ä¸­æ–­ï¼","ç¡®è®¤ç¦»å¼€å—ï¼Ÿ",{confirmButtonText:"ç»§ç»­è€ƒè¯•",cancelButtonText:"ç¡®è®¤ç¦»å¼€",type:"warning",closeOnPressEscape:!1,distinguishCancelAndClose:!0}).then(a=>{n(!1)}).catch(a=>{a=="cancel"?n():n(!1)})}),(t,u)=>{const n=U,a=V,m=R,i=K,y=G,I=Q,N=z,v=L;return d(),x(v,null,{default:o(()=>[r(a,null,{default:o(()=>[p("span",null,"ã€"+f(e.name)+"ã€‘",1),r(P,{seconds:e.exam_seconds,type:2,split:h.value,timeUnit:[":",":",":"],stop:e.state==g(s).FINISHED,onTimeUp:E},null,8,["seconds","split","stop"]),r(n,{link:"",type:"primary",disabled:e.state==g(s).FINISHED,onClick:w},{default:o(()=>[O("äº¤å·")]),_:1},8,["disabled"])]),_:1}),r(N,null,{default:o(()=>[r(I,{gutter:16,class:"q-body"},{default:o(()=>[(d(!0),T(H,null,$(e.meta,_=>(d(),x(y,{xs:24,sm:12,md:8,lg:6,xl:4},{default:o(()=>[r(i,null,{default:o(()=>[p("span",J,f(_.title),1),r(m,{class:"clear-number-input",modelValue:_.user_answer,"onUpdate:modelValue":M=>_.user_answer=M,max:999,clearable:"",type:"number",disabled:e.state==g(s).FINISHED},null,8,["modelValue","onUpdate:modelValue","disabled"]),p("span",null,f(_.mark),1)]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})}}});const oe=A(W,[["__scopeId","data-v-56892d5a"]]);export{oe as default};
