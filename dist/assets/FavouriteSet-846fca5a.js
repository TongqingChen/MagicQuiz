import{d as S,u as T,j as I,r as p,e as V,A as h,o as f,m as A,b as n,$ as D,p as a,c as g,w as u,f as w,an as Q,q as z,F as N,ao as b,k as M,E as R,i as L,_ as G}from"./index-fed7c948.js";import{Q as H}from"./QuestionDialog-054568e5.js";/* empty css                 */import{E as J,a as K}from"./el-table-column-6ec652ed.js";import"./el-tag-de887b4f.js";import{Q as O}from"./QuizCascader-799960f9.js";import{E as P}from"./index-a68bdda9.js";import{v as U}from"./directive-1d1584c6.js";import"./el-image-viewer-1ed91e83.js";import"./debounce-2dbe537a.js";import"./isEqual-5580e0c1.js";import"./el-radio-group-b731278a.js";/* empty css                        */const W=S({__name:"FavouriteSet",setup(X){const q=T();let _=I(!0);var x=p([]),v=p([]),i=p([]);const l=p([]),e=p({subject:{id:0,name:""},grade:{id:0,name:""},volume:{id:0,name:""},drawerVisible:!1,qidx:-1}),y=(s,o,t)=>{e.subject=s,e.grade=o,e.volume=t,_.value=!0,i.splice(0);var r=x.filter(d=>d.subject.id==s.id&&d.grade.id==o.id&&d.volume.id==t.id);i=v.filter(d=>r.some(c=>c.quiz.id==d.qz_id)),_.value=!1},k=s=>{e.qidx=s,e.drawerVisible=!0},C=s=>{e.qidx=s,b.confirm(`从收藏集里删除本题【${i[e.qidx].title.substring(0,10)}...】吗？`,"请确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await h.deleteFavouriteQuestion(i[e.qidx].qid).then(async o=>{M({message:"删除成功.",type:"success"})})})};V(()=>{h.getFavouriteSetsBySubInfos().then(s=>{x=s.data.quizs,x.forEach(o=>{var t=l.findIndex(c=>c.v.id==o.subject.id);t<0&&(t=l.length,l.push({v:o.subject,children:[]}));var r=l[t].children.findIndex(c=>c.v.id==o.grade.id);r<0&&(r=l[t].children.length,l[t].children.push({v:o.grade,children:[]}));var d=l[t].children[r].children.findIndex(c=>c.id==o.volume.id);d<0&&(d=l[t].children[r].children.length,l[t].children[r].children.push(o.volume))}),v=s.data.questions,_.value=!1})});const $=()=>{b.confirm(`开始【${e.subject.name}⭐${e.grade.name}⭐${e.volume.name}《收藏题集》】(60分钟)考试吗？`,"请确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{q.push({path:"/exam",query:{id:-3,name:"收藏题集",subject:e.subject.name,grade:e.grade.name,volume:e.volume.name,exam_seconds:60*60}})})},E=({row:s,rowIndex:o})=>o%2==0?"success-row":"";return(s,o)=>{const t=J,r=R,d=K,c=L,j=P,B=U;return f(),A(N,null,[n(O,{options:l,onClicked:y},null,8,["options"]),D((f(),g(d,{data:a(i),"row-class-name":E,border:"",style:{width:"100%",color:"darkslategray","font-size":"12px"}},{default:u(()=>[n(t,{fixed:"",type:"index",width:"32px"}),n(t,{prop:"qz_name",label:"试卷名",width:"88px",sortable:"","show-overflow-tooltip":""}),n(t,{prop:"type",label:"题型",width:"60px",sortable:""}),n(t,{prop:"title",label:"题目","show-overflow-tooltip":""}),n(t,{prop:"description",label:"描述","show-overflow-tooltip":""}),n(t,{prop:"level",label:"难度",width:"60px",sortable:""}),n(t,{fixed:"right",label:"查看",width:"40px"},{default:u(m=>[n(r,{link:"",type:"primary",size:"small",onClick:F=>k(m.$index)},{default:u(()=>[w("详情")]),_:2},1032,["onClick"])]),_:1}),n(t,{fixed:"right",label:"删除",width:"40px"},{default:u(m=>[n(r,{link:"",type:"primary",size:"small",onClick:F=>C(m.$index)},{default:u(()=>[w("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[B,a(_)]]),a(i).length>0?(f(),g(j,{key:0,position:"bottom",offset:20},{default:u(()=>[n(c,{placement:"right",content:"收藏题考试"},{default:u(()=>[n(r,{type:"primary",icon:a(Q),circle:"",onClick:$},null,8,["icon"])]),_:1})]),_:1})):z("",!0),n(H,{visible:e.drawerVisible,id:e.qidx>=0?a(i)[e.qidx].qid:0,wrong_times:e.qidx>=0?a(i)[e.qidx].wrong_times:0,is_favourited:e.qidx>=0?a(i)[e.qidx].is_favourited:!1,header:e.qidx>=0?`${a(i)[e.qidx].qid}.【${e.subject.name} | ${e.grade.name} | ${e.volume.name}】${a(i)[e.qidx].qz_name}`:"",title:e.qidx>=0?a(i)[e.qidx].title:"",image:e.qidx>=0?a(i)[e.qidx].image:"",description:e.qidx>=0?a(i)[e.qidx].description:"",analysis:e.qidx>=0?a(i)[e.qidx].analysis:"",answer:e.qidx>=0?a(i)[e.qidx].answer:"",userAnswer:e.qidx>=0?a(i)[e.qidx].user_answer:"",onClose:o[0]||(o[0]=m=>{a(i)[e.qidx].is_favourited=m,e.drawerVisible=!1})},null,8,["visible","id","wrong_times","is_favourited","header","title","image","description","analysis","answer","userAnswer"])],64)}}});const ue=G(W,[["__scopeId","data-v-f51d648c"]]);export{ue as default};
