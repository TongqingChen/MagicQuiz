import{d as T,u as I,j as S,r as p,e as V,A as h,o as _,m as A,b as n,$ as D,p as a,c as b,w as u,f as g,an as Q,q as z,F as N,ao as w,k as M,E as R,i as L,_ as G}from"./index-497a94ff.js";import{Q as H}from"./QuestionDialog-851bb68a.js";/* empty css                 */import{E as J,a as K}from"./el-table-column-83f2b486.js";import"./el-tag-c8052f62.js";import{Q as O}from"./QuizCascader-f5648622.js";import{E as P}from"./index-9f51bc69.js";import{v as U}from"./directive-b2d733fd.js";import"./el-image-viewer-3965d51d.js";import"./debounce-74e9c51d.js";import"./isEqual-0285f7e8.js";import"./el-radio-group-20a1dd4d.js";/* empty css                        */const W=T({__name:"FavoriteSet",setup(X){const q=I();let x=S(!0);var f=p([]),v=p([]),i=p([]);const l=p([]),e=p({subject:{id:0,name:""},grade:{id:0,name:""},volume:{id:0,name:""},drawerVisible:!1,qidx:-1});V(()=>{h.getFavouriteSetsBySubInfos().then(s=>{f=s.data.quizs,f.forEach(o=>{var t=l.findIndex(c=>c.v.id==o.subject.id);t<0&&(t=l.length,l.push({v:o.subject,children:[]}));var r=l[t].children.findIndex(c=>c.v.id==o.grade.id);r<0&&(r=l[t].children.length,l[t].children.push({v:o.grade,children:[]}));var d=l[t].children[r].children.findIndex(c=>c.id==o.volume.id);d<0&&(d=l[t].children[r].children.length,l[t].children[r].children.push(o.volume))}),v=s.data.questions,x.value=!1})});const y=(s,o,t)=>{e.subject=s,e.grade=o,e.volume=t,x.value=!0,e.qidx=-1,i.splice(0);var r=f.filter(d=>d.subject.id==s.id&&d.grade.id==o.id&&d.volume.id==t.id);i=v.filter(d=>r.some(c=>c.quiz.id==d.qz_id)),x.value=!1},k=s=>{e.qidx=s,e.drawerVisible=!0},C=s=>{e.qidx=s,w.confirm(`从收藏集里删除本题【${i[e.qidx].title.substring(0,10)}...】吗？`,"请确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await h.deleteFavouriteQuestion(i[e.qidx].qid).then(async o=>{M({message:"删除成功.",type:"success"})})})},$=()=>{w.confirm(`开始【${e.subject.name}⭐${e.grade.name}⭐${e.volume.name}《收藏题集》】(60分钟)考试吗？`,"请确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{q.push({path:"/exam",query:{id:-3,name:"收藏题集",subject:e.subject.name,grade:e.grade.name,volume:e.volume.name,exam_seconds:60*60}})})},E=({row:s,rowIndex:o})=>o%2==0?"success-row":"";return(s,o)=>{const t=J,r=R,d=K,c=L,j=P,B=U;return _(),A(N,null,[n(O,{options:l,onClicked:y},null,8,["options"]),D((_(),b(d,{data:a(i),"row-class-name":E,border:"",style:{width:"100%",color:"darkslategray","font-size":"12px"}},{default:u(()=>[n(t,{fixed:"",type:"index",width:"32px"}),n(t,{prop:"qz_name",label:"试卷名",width:"88px",sortable:"","show-overflow-tooltip":""}),n(t,{prop:"type",label:"题型",width:"60px",sortable:""}),n(t,{prop:"title",label:"题目","show-overflow-tooltip":""}),n(t,{prop:"description",label:"描述","show-overflow-tooltip":""}),n(t,{prop:"level",label:"难度",width:"60px",sortable:""}),n(t,{fixed:"right",label:"删除",width:"40px"},{default:u(m=>[n(r,{link:"",type:"primary",size:"small",onClick:F=>C(m.$index)},{default:u(()=>[g("删除")]),_:2},1032,["onClick"])]),_:1}),n(t,{fixed:"right",label:"查看",width:"40px"},{default:u(m=>[n(r,{link:"",type:"primary",size:"small",onClick:F=>k(m.$index)},{default:u(()=>[g("详情")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[B,a(x)]]),a(i).length>0?(_(),b(j,{key:0,position:"bottom",offset:20},{default:u(()=>[n(c,{placement:"right",content:"收藏题考试"},{default:u(()=>[n(r,{type:"primary",icon:a(Q),circle:"",onClick:$},null,8,["icon"])]),_:1})]),_:1})):z("",!0),n(H,{visible:e.drawerVisible,id:e.qidx>=0?a(i)[e.qidx].qid:0,wrong_times:e.qidx>=0?a(i)[e.qidx].wrong_times:0,is_favourited:e.qidx>=0?a(i)[e.qidx].is_favourited:!1,header:e.qidx>=0?`${a(i)[e.qidx].qid}.【${e.subject.name} | ${e.grade.name} | ${e.volume.name}】${a(i)[e.qidx].qz_name}`:"",title:e.qidx>=0?a(i)[e.qidx].title:"",image:e.qidx>=0?a(i)[e.qidx].image:"",description:e.qidx>=0?a(i)[e.qidx].description:"",analysis:e.qidx>=0?a(i)[e.qidx].analysis:"",answer:e.qidx>=0?a(i)[e.qidx].answer:"",userAnswer:e.qidx>=0?a(i)[e.qidx].user_answer:"",onClose:o[0]||(o[0]=m=>{a(i)[e.qidx].is_favourited=m,e.drawerVisible=!1})},null,8,["visible","id","wrong_times","is_favourited","header","title","image","description","analysis","answer","userAnswer"])],64)}}});const ue=G(W,[["__scopeId","data-v-9ec94ab7"]]);export{ue as default};
