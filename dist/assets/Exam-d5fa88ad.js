import{b as X,ab as Y,d as k,u as Z,c as R,o as m,a as h,n as T,f as i,h as ee,g as x,s as te,_ as se,j as ae,x as G,N as ne,p as oe,b9 as ie,e as E,w as a,A as N,ba as re,l as o,k as b,t as _,q as u,y as V,F as Q,aA as le,aw as de,ai as ue,bb as me,bc as ce,bd as pe,z as _e,E as fe,be as ye,m as ve}from"./index-28534dab.js";import{E as ge}from"./el-image-viewer-bdd56cfc.js";import{b as be,E as we}from"./el-radio-group-babcad32.js";import{E as Ee}from"./el-text-2cc75364.js";/* empty css                        */import{E as xe}from"./el-switch-1762b96b.js";import{E as he}from"./el-scrollbar-9be32fa1.js";import{E as Ie,f as Ne}from"./el-button-898efb30.js";import{E as Ce,a as f,Q as y,b as Oe,_ as Ge}from"./Timer.vue_vue_type_script_setup_true_lang-1df9ab43.js";import{Q as ke}from"./http-37cefeec.js";import{E as $}from"./index-ca622293.js";import{E as Le}from"./index-6cd4b727.js";import"./debounce-72453ca1.js";import"./index-1e9469b0.js";import"./scroll-dc2f35e5.js";import"./validator-e2a941f8.js";import"./index-224d0693.js";import"./index-a22de1b4.js";const ze=X({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:Y(String),default:"solid"}}),Se=k({name:"ElDivider"}),Ae=k({...Se,props:ze,setup(L){const g=L,e=Z("divider"),v=R(()=>e.cssVar({"border-style":g.borderStyle}));return(c,z)=>(m(),h("div",{class:T([i(e).b(),i(e).m(c.direction)]),style:te(i(v)),role:"separator"},[c.$slots.default&&c.direction!=="vertical"?(m(),h("div",{key:0,class:T([i(e).e("text"),i(e).is(c.contentPosition)])},[ee(c.$slots,"default")],2)):x("v-if",!0)],6))}});var Be=se(Ae,[["__file","/home/runner/work/element-plus/element-plus/packages/components/divider/src/divider.vue"]]);const De=ae(Be);const Te={style:{margin:"5px"}},Ve={class:"question-zone"},Qe={style:{"padding-left":"6px","padding-top":"5px"}},$e={class:"answer"},Re={key:0,class:"answer"},Me={class:"question"},He={class:"title"},Pe=k({__name:"Exam",setup(L){const g=me(),e=G(new Ce);let v=G([[0,0]]);const c=ne(!1),z=R(()=>c.value?"primary":"default"),M=()=>{e.id=Number(g.query.id),e.state=f.IDLE,e.start_time=Date.now(),e.name=String(g.query.name),e.subjectId=Number(g.query.subjectId),e.subjectName=String(g.query.subjectName),e.exam_seconds=Number(g.query.exam_seconds),e.question_num=0,N.getQuestionListByQuizId(e.id).then(d=>{let s=d.data.results;e.meta=[{typeId:y.CHOICE,typeName:"选择",icon:"Message",qList:[]},{typeId:y.LOGIC,typeName:"判断",icon:"Setttings",qList:[]},{typeId:y.CODING,typeName:"编程",icon:"Menu",qList:[]}],e.scores=0,v=[];var l=0;s.forEach(n=>{v.push([n.type,e.meta[n.type].qList.length]),e.meta[n.type].qList.push({index:l++,id:n.id,type:n.type,title:n.title,description:n.description,image:n.image,answer:n.answer,displayType:"default",userAnswer:"未作答",score:n.score}),e.scores+=n.score}),e.question_num=s.length,e.state=f.ONGOING})};oe(()=>{M()}),ie((d,s,l)=>{if(e.state!=f.ONGOING){l();return}$.confirm("正在考试中，离开页面数据将会丢失，考试中断！","确认离开吗？",{confirmButtonText:"继续考试",cancelButtonText:"确认离开",type:"warning",closeOnPressEscape:!1,distinguishCancelAndClose:!0}).then(n=>{l(!1)}).catch(n=>{n=="cancel"?l():l(!1)})});const t=G({meta:new Oe,answers:["","",""]}),I=d=>{t.meta=e.meta[v[d][0]].qList[v[d][1]],t.answers[t.meta.type]=t.meta.userAnswer},S=()=>{if(t.meta.index>=0&&e.state==f.ONGOING){var d=v[t.meta.index][0],s=v[t.meta.index][1];e.meta[d].qList[s].userAnswer=t.answers[t.meta.type],e.meta[d].qList[s].displayType="primary",c.value&&t.meta.index<e.question_num-1&&I(t.meta.index+1)}},A=async()=>{e.state=f.FINISHED;var d=N.loadUserIdFromStorage(),s=new ke,l=0,n=[0,0,0];e.meta.forEach(C=>{C.qList.forEach(r=>{r.displayType=r.userAnswer==r.answer?"success":"danger",r.userAnswer==r.answer&&(s.meta.abs_score+=r.score,n[r.type]++),r.type!=y.CODING&&(l+=r.score,s.questions.push({user:d,question:r.id,user_answer:r.userAnswer,is_correct:r.userAnswer==r.answer}))})}),s.meta.note=`选择: ${n[y.CHOICE]}/${e.meta[y.CHOICE].qList.length}, 判断: ${n[y.LOGIC]}/${e.meta[y.LOGIC].qList.length}`,s.meta.user=d,s.meta.quiz=e.id,s.meta.rel_score=Math.round(s.meta.abs_score*100/l),s.meta.use_minutes=Math.round((Date.now()-e.start_time)/1e3/60),await N.postQuestionsResult(s.questions),await N.postQuizResult(s.meta),Le.success("考试提交成功!")},H=()=>{$.confirm("确定提交并结束考试吗？","请确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{A()})};return(d,s)=>{const l=Ie,n=ce,C=De,r=he,P=pe,j=Ee,F=xe,q=_e("ArrowRight"),U=fe,J=Ne,w=be,B=we,K=ge,W=ye,D=re;return m(),E(D,{class:"layout-container-exam",style:{height:"100%"}},{default:a(()=>[o(n,null,{default:a(()=>[b("span",null,"【"+_(e.subjectName)+"】"+_(e.name),1),o(Ge,{style:{color:"red"},start_flag:e.state==i(f).ONGOING,duration_secs:e.exam_seconds,blink:!0,start_text:"【考试剩余】",onEnd_event:A},null,8,["start_flag","duration_secs"]),o(l,{link:"",type:"primary",disabled:e.state!=i(f).ONGOING,onClick:H},{default:a(()=>[u("提交")]),_:1},8,["disabled"])]),_:1}),o(D,null,{default:a(()=>[o(P,{width:"164px"},{default:a(()=>[o(r,{style:{height:"100%"}},{default:a(()=>[(m(!0),h(Q,null,V(e.meta,p=>(m(),h("div",Te,[o(C,null,{default:a(()=>[u(_(p.typeName),1)]),_:2},1024),b("div",Ve,[(m(!0),h(Q,null,V(p.qList,O=>(m(),E(l,{type:O.displayType,class:"question-button",onClick:je=>I(O.index)},{default:a(()=>[u(_(O.index+1),1)]),_:2},1032,["type","onClick"]))),256))])]))),256))]),_:1})]),_:1}),t.meta.index>=0?(m(),E(W,{key:0},{default:a(()=>[b("div",Qe,[b("div",$e,"【考生答案】"+_(t.meta.userAnswer),1),e.state==i(f).FINISHED?(m(),h("div",Re," 【正确答案】"+_(t.meta.answer),1)):x("",!0),o(j,{type:i(z),size:"small",style:{"padding-left":"6px"}},{default:a(()=>[u("自动下一题")]),_:1},8,["type"]),o(F,{modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=p=>c.value=p),"inline-prompt":"","active-icon":i(le),"inactive-icon":i(de)},null,8,["modelValue","active-icon","inactive-icon"]),o(J,{style:{"padding-left":"6px"}},{default:a(()=>[o(l,{disabled:t.meta.index==0,type:"primary",icon:i(ue),size:"small",onClick:s[1]||(s[1]=p=>I(t.meta.index-1))},{default:a(()=>[u("上一题")]),_:1},8,["disabled","icon"]),o(l,{disabled:t.meta.index==i(v).length-1,type:"primary",size:"small",onClick:s[2]||(s[2]=p=>I(t.meta.index+1))},{default:a(()=>[u("下一题"),o(U,{class:"el-icon--right"},{default:a(()=>[o(q)]),_:1})]),_:1},8,["disabled"])]),_:1}),t.meta.type==i(y).CHOICE&&e.state==i(f).ONGOING?(m(),E(B,{key:1,modelValue:t.answers[0],"onUpdate:modelValue":s[3]||(s[3]=p=>t.answers[0]=p),onChange:S},{default:a(()=>[o(w,{label:"A",size:"small"},{default:a(()=>[u("A")]),_:1}),o(w,{label:"B",size:"small"},{default:a(()=>[u("B")]),_:1}),o(w,{label:"C",size:"small"},{default:a(()=>[u("C")]),_:1}),o(w,{label:"D",size:"small"},{default:a(()=>[u("D")]),_:1})]),_:1},8,["modelValue"])):x("",!0),t.meta.type==i(y).LOGIC&&e.state==i(f).ONGOING?(m(),E(B,{key:2,modelValue:t.answers[1],"onUpdate:modelValue":s[4]||(s[4]=p=>t.answers[1]=p),onChange:S},{default:a(()=>[o(w,{label:"T",size:"small"},{default:a(()=>[u("正确")]),_:1}),o(w,{label:"F",size:"small"},{default:a(()=>[u("错误")]),_:1})]),_:1},8,["modelValue"])):x("",!0)]),b("div",Me,[b("div",He,_(t.meta.index+1)+". ("+_(t.meta.score)+"分)"+_(t.meta.title),1),t.meta.image?(m(),E(K,{key:0,src:t.meta.image,fit:"scale-down"},null,8,["src"])):x("",!0),b("div",null,_(t.meta.description),1)])]),_:1})):x("",!0)]),_:1})]),_:1})}}});const dt=ve(Pe,[["__scopeId","data-v-a1f4fb3e"]]);export{dt as default};
