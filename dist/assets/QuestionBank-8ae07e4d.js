import{d as U,e as G,A as $,r as y,j as g,h as M,o as h,m as E,b as o,p as a,a as z,f as p,w as c,F as B,s as D,c as T,t as b,ap as H,$ as J,E as K,i as O,_ as P}from"./index-89aeeb22.js";import{Q as W}from"./QuestionDialog-8cc71ff7.js";import{E as X,a as Y}from"./el-table-column-00f217c6.js";import"./el-tag-a9b17241.js";import{E as Z,a as ee}from"./el-radio-group-9f69f746.js";/* empty css                        */import{Q as te}from"./QuizCascader-d036046c.js";import{v as ae}from"./directive-1618ec9e.js";import"./el-image-viewer-854bb0ac.js";import"./debounce-883dd20d.js";import"./isEqual-61dcd27d.js";const ie={class:"subject"},le={class:"subject"},ne=U({__name:"QuestionBank",setup(se){G(async()=>{await $.getQuizList().then(s=>{s.data.forEach(t=>{if(t.subject!=3){var e={quiz:{id:t.id,name:t.name},subject:{id:t.subject,name:t.subject_name},grade:{id:t.grade,name:t.grade_name},volume:{id:t.volume,name:t.volume_name}};V.push(e);var n=d.findIndex(u=>u.v.id==e.subject.id);n<0&&(n=d.length,d.push({v:e.subject,children:[]}));var _=d[n].children.findIndex(u=>u.v.id==e.grade.id);_<0&&(_=d[n].children.length,d[n].children.push({v:e.grade,children:[]}));var w=d[n].children[_].children.findIndex(u=>u.id==e.volume.id);w<0&&(w=d[n].children[_].children.length,d[n].children[_].children.push(e.volume))}})})});const j=["全部","单选","判断","填空","问答"],N=["简单","一般","困难"];let d=y([]),V=y([]),m=g(0),v=y([]);const f=g(0);let x=y([]),Q=g(""),i=-1;const k=g(!1),C=g(!1),R=s=>{i=s,k.value=!0},r=M(()=>(i=-1,x.filter(s=>f.value<0||s.type==f.value))),A=(s,t,e)=>{Q.value=`【${s.name} | ${t.name} | ${e.name}】`,v.splice(0),v=V.filter(n=>n.subject.id==s.id&&n.grade.id==t.id&&n.volume.id==e.id),v.length>0&&(m.value=v[0].quiz.id,Q.value+=v[0].quiz.name,I())},I=()=>{C.value=!0,x.splice(0),$.getQuestionListByQuizId(m.value).then(s=>{var t=1;s.data.forEach(e=>{x.push({index:t++,id:e.id,type:e.type,title:e.title,description:e.description,image:e.image,analysis:e.analysis,difficulty_level:e.difficulty_level,score:e.score,answer:e.answer,is_favourited:e.is_favourited,wrong_times:e.wrong_times})}),f.value=-1,C.value=!1})},S=({row:s,rowIndex:t})=>t%2?"":"success-row";return(s,t)=>{const e=Z,n=ee,_=K,w=O,u=X,q=Y,F=ae;return h(),E(B,null,[o(te,{options:a(d),onClicked:A},null,8,["options"]),z("div",ie,[p(" 试卷： "),o(n,{modelValue:a(m),"onUpdate:modelValue":t[0]||(t[0]=l=>H(m)?m.value=l:m=l),size:"small",onChange:I},{default:c(()=>[(h(!0),E(B,null,D(a(v),l=>(h(),T(e,{label:l.quiz.id},{default:c(()=>[p(b(l.quiz.name),1)]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),z("div",le,[p(" 题型： "),o(n,{modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=l=>f.value=l),size:"small"},{default:c(()=>[(h(),E(B,null,D(j,(l,L)=>o(e,{label:L-1},{default:c(()=>[p(b(l),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),J((h(),T(q,{data:r.value,style:{width:"100%","font-size":"12px"},"row-class-name":S,border:""},{default:c(()=>[o(u,{fixed:"",lable:"序号",width:"32px",align:"center"},{default:c(l=>[o(w,{effect:"dark",content:"详情"},{default:c(()=>[o(_,{link:"",type:"primary",size:"small",onClick:L=>R(l.$index)},{default:c(()=>[p(b(l.$index+1),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:1}),o(u,{label:"题型",width:"40px",align:"center"},{default:c(l=>[p(b(j[l.row.type+1]),1)]),_:1}),o(u,{prop:"title",label:"题目","show-overflow-tooltip":""}),o(u,{prop:"description",label:"描述","show-overflow-tooltip":""}),o(u,{label:"难度",width:"40px",align:"center"},{default:c(l=>[p(b(N[l.row.difficulty_level]),1)]),_:1})]),_:1},8,["data"])),[[F,C.value]]),o(W,{visible:k.value,wrong_times:a(i)>=0?r.value[a(i)].wrong_times:0,id:a(i)>=0?r.value[a(i)].id:0,is_favourited:a(i)>=0?r.value[a(i)].is_favourited:!1,header:a(i)>=0?`${r.value[a(i)].id}. ${a(Q)}`:"",title:a(i)>=0?r.value[a(i)].title:"",image:a(i)>=0?r.value[a(i)].image:"",description:a(i)>=0?r.value[a(i)].description:"",analysis:a(i)>=0?r.value[a(i)].analysis:"",answer:a(i)>=0?r.value[a(i)].answer:"",userAnswer:null,onClose:t[2]||(t[2]=l=>{r.value[a(i)].is_favourited=l,k.value=!1})},null,8,["visible","wrong_times","id","is_favourited","header","title","image","description","analysis","answer"])],64)}}});const he=P(ne,[["__scopeId","data-v-89b3ac76"]]);export{he as default};
