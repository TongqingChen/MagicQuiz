import{b as Z,d as ee,e as S,u as te,f as q,o as _,j as w,s as T,k as d,q as se,A as N,n as ae,_ as ne,t as oe,r as V,R as G,O as ie,S as I,bf as re,l as h,m as n,bg as le,z as i,x as E,y as g,P as p,V as M,U as Q,aJ as de,ax as ue,aq as ce,bh as me,bi as pe,bj as _e,X as fe,E as ye,bk as ge,N as ve}from"./index-0e95c451.js";import{E as Ee}from"./el-image-viewer-8071e90f.js";import{b as be,E as xe}from"./el-radio-group-8706f8ea.js";import{E as Ie}from"./el-text-b89ea41d.js";/* empty css                        */import{E as he}from"./el-switch-762f3edc.js";import{E as Ne}from"./el-scrollbar-52888195.js";import{E as we,f as Ce}from"./el-button-cf97a925.js";import{E as Oe,a as f,Q as u,b as Le,_ as Ge}from"./Timer.vue_vue_type_script_setup_true_lang-81bff904.js";import{Q as Se}from"./http-67e17b5c.js";import{S as ke}from"./settings-6a4cda4d.js";import{b as $}from"./index-3b6a7a14.js";import{E as ze}from"./index-5d5efdde.js";import"./debounce-3cd5c236.js";import"./index-a01ffc93.js";import"./validator-a720dd50.js";const Ae=Z({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:ee(String),default:"solid"}}),Be=S({name:"ElDivider"}),De=S({...Be,props:Ae,setup(k){const b=k,v=te("divider"),e=q(()=>v.cssVar({"border-style":b.borderStyle}));return(c,C)=>(_(),w("div",{class:T([d(v).b(),d(v).m(c.direction)]),style:ae(d(e)),role:"separator"},[c.$slots.default&&c.direction!=="vertical"?(_(),w("div",{key:0,class:T([d(v).e("text"),d(v).is(c.contentPosition)])},[se(c.$slots,"default")],2)):N("v-if",!0)],6))}});var Te=ne(De,[["__file","/home/runner/work/element-plus/element-plus/packages/components/divider/src/divider.vue"]]);const Ve=oe(Te);const Me={style:{margin:"5px"}},Qe={class:"question-zone"},$e={style:{"padding-left":"6px","padding-top":"5px"}},qe={class:"answer"},Re={key:0,class:"answer"},He={class:"question"},Pe={class:"title"},je=S({__name:"Exam",setup(k){const b=me(),v=V(!0),e=G(new Oe);let c=G([[0,0]]);const C=V(!1),R=q(()=>C.value?"primary":"default"),H=()=>{e.id=Number(b.query.id),e.state=f.IDLE,e.start_time=Date.now(),e.name=String(b.query.name),e.subjectName=String(b.query.sub_name),e.exam_seconds=Number(b.query.exam_seconds),e.question_num=0,e.id>=0?I.getQuestionListByQuizId(e.id).then(l=>{let t=l.data.results;e.meta=[{typeId:u.CHOICE,typeName:"选择",icon:"Message",qList:[]},{typeId:u.LOGIC,typeName:"判断",icon:"Setttings",qList:[]},{typeId:u.CODING,typeName:"编程",icon:"Menu",qList:[]}],e.scores=0,c=[];var r=0;t.forEach(a=>{c.push([a.type,e.meta[a.type].qList.length]),e.meta[a.type].qList.push({index:r++,id:a.id,type:a.type,title:a.title,description:a.description,image:a.image,answer:a.answer,displayType:"default",userAnswer:"未作答",score:a.score}),e.scores+=a.score}),e.question_num=t.length,e.state=f.ONGOING}):I.getWrongSetsMixedBySubName(e.subjectName).then(l=>{const t=l.data[e.subjectName],r=["选择","判断","编程"];e.meta=[{typeId:u.CHOICE,typeName:r[u.CHOICE],icon:"Message",qList:[]},{typeId:u.LOGIC,typeName:r[u.LOGIC],icon:"Setttings",qList:[]},{typeId:u.CODING,typeName:r[u.CODING],icon:"Menu",qList:[]}],e.scores=0,c=[];var a=0;t.forEach(m=>{var o=r.indexOf(m.type);c.push([o,e.meta[o].qList.length]),e.meta[o].qList.push({index:a++,id:m.qid,type:o,title:m.title,description:m.description,image:m.image,answer:m.answer,displayType:"default",userAnswer:"未作答",score:m.score}),e.scores+=m.score}),e.question_num=t.length,e.state=f.ONGOING})};ie(()=>{H();var l=I.loadSettings();l&&(v.value=l.data[ke.EXAM_TIME_BLINK].value)}),re((l,t,r)=>{if(e.state!=f.ONGOING){r();return}$.confirm("正在考试中，离开页面数据将会丢失，考试中断！","确认离开吗？",{confirmButtonText:"继续考试",cancelButtonText:"确认离开",type:"warning",closeOnPressEscape:!1,distinguishCancelAndClose:!0}).then(a=>{r(!1)}).catch(a=>{a=="cancel"?r():r(!1)})});const s=G({meta:new Le,answers:["","",""]}),O=l=>{s.meta=e.meta[c[l][0]].qList[c[l][1]],s.answers[s.meta.type]=s.meta.userAnswer},z=()=>{if(s.meta.index>=0&&e.state==f.ONGOING){var l=c[s.meta.index][0],t=c[s.meta.index][1];e.meta[l].qList[t].userAnswer=s.answers[s.meta.type],e.meta[l].qList[t].displayType="primary",C.value&&s.meta.index<e.question_num-1&&O(s.meta.index+1)}},A=async()=>{e.state=f.FINISHED;var l=I.loadUserIdFromStorage(),t=new Se,r=0,a=[0,0,0];e.meta.forEach(m=>{m.qList.forEach(o=>{o.displayType=o.userAnswer==o.answer?"success":"danger",o.userAnswer==o.answer&&(t.meta.abs_score+=o.score,a[o.type]++),o.type!=u.CODING&&(r+=o.score,t.questions.push({user:l,question:o.id,user_answer:o.userAnswer,is_correct:o.userAnswer==o.answer}))})}),t.meta.note=`选择: ${a[u.CHOICE]}/${e.meta[u.CHOICE].qList.length}, 判断: ${a[u.LOGIC]}/${e.meta[u.LOGIC].qList.length}`,t.meta.user=l,t.meta.quiz=e.id,t.meta.rel_score=Math.round(t.meta.abs_score*100/r),t.meta.use_minutes=Math.round((Date.now()-e.start_time)/1e3/60),await I.postQuestionsResult(t.questions),e.id>=0&&await I.postQuizResult(t.meta),ze.success("考试提交成功!")},P=()=>{$.confirm("确定提交并结束考试吗？","请确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{A()})};return(l,t)=>{const r=we,a=pe,m=Ve,o=Ne,j=_e,F=Ie,U=he,X=fe("ArrowRight"),J=ye,K=Ce,x=be,B=xe,W=Ee,Y=ge,D=le;return _(),h(D,{class:"layout-container-exam",style:{height:"100%"}},{default:n(()=>[i(a,null,{default:n(()=>[E("span",null,"【"+g(e.subjectName)+"】"+g(e.name),1),i(Ge,{style:{color:"red"},start_flag:e.state==d(f).ONGOING,duration_secs:e.exam_seconds,blink:v.value,start_text:"【考试剩余】",onEnd_event:A},null,8,["start_flag","duration_secs","blink"]),i(r,{link:"",type:"primary",disabled:e.state!=d(f).ONGOING,onClick:P},{default:n(()=>[p("提交")]),_:1},8,["disabled"])]),_:1}),i(D,null,{default:n(()=>[i(j,{width:"164px"},{default:n(()=>[i(o,{style:{height:"100%"}},{default:n(()=>[(_(!0),w(Q,null,M(e.meta,y=>(_(),w("div",Me,[i(m,null,{default:n(()=>[p(g(y.typeName),1)]),_:2},1024),E("div",Qe,[(_(!0),w(Q,null,M(y.qList,L=>(_(),h(r,{type:L.displayType,class:"question-button",onClick:Fe=>O(L.index)},{default:n(()=>[p(g(L.index+1),1)]),_:2},1032,["type","onClick"]))),256))])]))),256))]),_:1})]),_:1}),s.meta.index>=0?(_(),h(Y,{key:0},{default:n(()=>[E("div",$e,[E("div",qe,"【考生答案】"+g(s.meta.userAnswer),1),e.state==d(f).FINISHED?(_(),w("div",Re,"【正确答案】"+g(s.meta.answer),1)):N("",!0),i(F,{type:d(R),size:"small",style:{"padding-left":"6px"}},{default:n(()=>[p("自动下一题")]),_:1},8,["type"]),i(U,{modelValue:C.value,"onUpdate:modelValue":t[0]||(t[0]=y=>C.value=y),"inline-prompt":"","active-icon":d(de),"inactive-icon":d(ue)},null,8,["modelValue","active-icon","inactive-icon"]),i(K,{style:{"padding-left":"6px"}},{default:n(()=>[i(r,{disabled:s.meta.index==0,type:"primary",icon:d(ce),size:"small",onClick:t[1]||(t[1]=y=>O(s.meta.index-1))},{default:n(()=>[p("上一题")]),_:1},8,["disabled","icon"]),i(r,{disabled:s.meta.index==d(c).length-1,type:"primary",size:"small",onClick:t[2]||(t[2]=y=>O(s.meta.index+1))},{default:n(()=>[p("下一题"),i(J,{class:"el-icon--right"},{default:n(()=>[i(X)]),_:1})]),_:1},8,["disabled"])]),_:1}),s.meta.type==d(u).CHOICE&&e.state==d(f).ONGOING?(_(),h(B,{key:1,modelValue:s.answers[0],"onUpdate:modelValue":t[3]||(t[3]=y=>s.answers[0]=y),onChange:z},{default:n(()=>[i(x,{label:"A",size:"small"},{default:n(()=>[p("A")]),_:1}),i(x,{label:"B",size:"small"},{default:n(()=>[p("B")]),_:1}),i(x,{label:"C",size:"small"},{default:n(()=>[p("C")]),_:1}),i(x,{label:"D",size:"small"},{default:n(()=>[p("D")]),_:1})]),_:1},8,["modelValue"])):N("",!0),s.meta.type==d(u).LOGIC&&e.state==d(f).ONGOING?(_(),h(B,{key:2,modelValue:s.answers[1],"onUpdate:modelValue":t[4]||(t[4]=y=>s.answers[1]=y),onChange:z},{default:n(()=>[i(x,{label:"T",size:"small"},{default:n(()=>[p("正确")]),_:1}),i(x,{label:"F",size:"small"},{default:n(()=>[p("错误")]),_:1})]),_:1},8,["modelValue"])):N("",!0)]),E("div",He,[E("div",Pe,g(s.meta.index+1)+". ("+g(s.meta.score)+"分)"+g(s.meta.title),1),s.meta.image?(_(),h(W,{key:0,src:s.meta.image,fit:"scale-down"},null,8,["src"])):N("",!0),E("div",null,g(s.meta.description),1)])]),_:1})):N("",!0)]),_:1})]),_:1})}}});const dt=ve(je,[["__scopeId","data-v-de09c945"]]);export{dt as default};
