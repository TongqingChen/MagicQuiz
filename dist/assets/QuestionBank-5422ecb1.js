import{d as F,r as w,k as h,h as U,e as G,A as $,o as g,p as B,b as r,u as e,a as z,f as _,w as c,F as E,s as D,c as T,t as y,ap as M,$ as H,E as J,_ as K}from"./index-e5e4a600.js";import{Q as O}from"./QuestionDialog-9240a86e.js";import{E as P,a as W}from"./el-table-column-3054f9a6.js";import"./el-tag-298d0148.js";import{E as X,a as Y}from"./el-radio-group-0f7419ac.js";/* empty css                        */import{Q as Z}from"./QuizCascader-b074baf8.js";import{v as ee}from"./directive-b12bfa49.js";import"./el-image-viewer-281876fc.js";import"./debounce-2e12e8c5.js";const te={class:"subject"},ie={class:"subject"},ae=F({__name:"QuestionBank",setup(le){const V=["全部","单选","判断","填空","问答"],N=["简单","一般","困难"];let u=w([]),j=w([]),m=h(0),f=w([]);const v=h(0);let x=w([]);const d=U(()=>x.filter(n=>v.value<0||n.type==v.value));let Q=h(""),a=-1;const k=h(!1),C=h(!1),R=n=>{a=n,k.value=!0},A=(n,i,t)=>{Q.value=`【${n.name} | ${i.name} | ${t.name}】`,f.splice(0),f=j.filter(s=>s.subject.id==n.id&&s.grade.id==i.id&&s.volume.id==t.id),f.length>0&&(m.value=f[0].quiz.id,Q.value+=f[0].quiz.name,I())},I=()=>{C.value=!0,x.splice(0),$.getQuestionListByQuizId(m.value).then(n=>{var i=1;n.data.forEach(t=>{x.push({index:i++,id:t.id,type:t.type,title:t.title,description:t.description,image:t.image,analysis:t.analysis,difficulty_level:t.difficulty_level,score:t.score,answer:t.answer,is_favourited:t.is_favourited,wrong_times:t.wrong_times})}),v.value=-1,C.value=!1})},S=({row:n,rowIndex:i})=>i%2?"":"success-row";return G(async()=>{await $.getQuizList().then(n=>{n.data.forEach(i=>{if(i.subject!=3){var t={quiz:{id:i.id,name:i.name},subject:{id:i.subject,name:i.subject_name},grade:{id:i.grade,name:i.grade_name},volume:{id:i.volume,name:i.volume_name}};j.push(t);var s=u.findIndex(p=>p.v.id==t.subject.id);s<0&&(s=u.length,u.push({v:t.subject,children:[]}));var o=u[s].children.findIndex(p=>p.v.id==t.grade.id);o<0&&(o=u[s].children.length,u[s].children.push({v:t.grade,children:[]}));var b=u[s].children[o].children.findIndex(p=>p.id==t.volume.id);b<0&&(b=u[s].children[o].children.length,u[s].children[o].children.push(t.volume))}})})}),(n,i)=>{const t=X,s=Y,o=P,b=J,p=W,q=ee;return g(),B(E,null,[r(Z,{options:e(u),onClicked:A},null,8,["options"]),z("div",te,[_(" 试卷： "),r(s,{modelValue:e(m),"onUpdate:modelValue":i[0]||(i[0]=l=>M(m)?m.value=l:m=l),size:"small",onChange:I},{default:c(()=>[(g(!0),B(E,null,D(e(f),l=>(g(),T(t,{label:l.quiz.id},{default:c(()=>[_(y(l.quiz.name),1)]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),z("div",ie,[_(" 题型： "),r(s,{modelValue:v.value,"onUpdate:modelValue":i[1]||(i[1]=l=>v.value=l),size:"small"},{default:c(()=>[(g(),B(E,null,D(V,(l,L)=>r(t,{label:L-1},{default:c(()=>[_(y(l),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),H((g(),T(p,{data:e(d),style:{width:"100%","font-size":"12px"},"row-class-name":S,border:""},{default:c(()=>[r(o,{fixed:"",type:"index",width:"32px"}),r(o,{label:"题型",width:"40px"},{default:c(l=>[_(y(V[l.row.type+1]),1)]),_:1}),r(o,{prop:"title",label:"题目","show-overflow-tooltip":""}),r(o,{prop:"description",label:"描述","show-overflow-tooltip":""}),r(o,{label:"难度",width:"40px"},{default:c(l=>[_(y(N[l.row.difficulty_level]),1)]),_:1}),r(o,{fixed:"right",label:"查看",width:"40px"},{default:c(l=>[r(b,{link:"",type:"primary",size:"small",onClick:L=>R(l.$index)},{default:c(()=>[_("详情")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[q,C.value]]),r(O,{visible:k.value,wrong_times:e(a)>=0?e(d)[e(a)].wrong_times:0,id:e(a)>=0?e(d)[e(a)].id:0,is_favourited:e(a)>=0?e(d)[e(a)].is_favourited:!1,header:e(a)>=0?`${e(d)[e(a)].id}. ${e(Q)}`:"",title:e(a)>=0?e(d)[e(a)].title:"",image:e(a)>=0?e(d)[e(a)].image:"",description:e(a)>=0?e(d)[e(a)].description:"",analysis:e(a)>=0?e(d)[e(a)].analysis:"",answer:e(a)>=0?e(d)[e(a)].answer:"",userAnswer:null,onClose:i[2]||(i[2]=l=>{e(d)[e(a)].is_favourited=l,k.value=!1})},null,8,["visible","wrong_times","id","is_favourited","header","title","image","description","analysis","answer"])],64)}}});const fe=K(ae,[["__scopeId","data-v-c566b49a"]]);export{fe as default};
