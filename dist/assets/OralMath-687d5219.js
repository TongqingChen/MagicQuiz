import{d as k,v as O,p as v,A as c,b9 as M,e as f,w as n,bb as B,ba as C,o as m,l as o,k as u,t as i,f as d,q as D,a as S,x as V,F as q,bc as F,be as G,m as R}from"./index-d1ec9bbb.js";import{E as H,a as $}from"./el-row-09765195.js";import{E as z}from"./el-card-dbc9b9ce.js";/* empty css                 */import{E as A}from"./el-button-39435904.js";import{a as r,_ as L,c as Q}from"./Timer.vue_vue_type_script_setup_true_lang-c4b7f0ae.js";import{Q as T}from"./http-6cc81244.js";import{E as U}from"./index-e60a1986.js";import{E as P}from"./index-d6e4858e.js";import"./use-form-item-d6cebf64.js";import"./index-abb94269.js";import"./scroll-6b723a30.js";import"./validator-40838779.js";import"./index-5a242a52.js";const j={class:"question"},J=k({__name:"OralMath",setup(K){const e=O({id:0,name:"",state:r.IDLE,start_time:0,meta:[{title:"",answer:0,user_answer:0,mark:""}]}),p=B();v(()=>{e.id=Number(p.query.id),e.name=String(p.query.name),e.state=r.ONGOING,c.getOralMath(e.id).then(s=>{e.meta=[],s.data.forEach(l=>e.meta.push({title:l[0],answer:l[1],user_answer:0,mark:""})),e.start_time=Date.now()})});const E=async()=>{var s=0;e.meta.forEach(a=>{a.mark=a.answer==a.user_answer?"✅":"❌",s+=a.answer==a.user_answer?1:0});var l=c.loadUserIdFromStorage(),t=new T;t.meta.note=`[${e.name}]${s}/${e.meta.length}`,t.meta.user=l,t.meta.quiz=e.id,t.meta.abs_score=s,t.meta.rel_score=Math.round(s*100/e.meta.length),t.meta.use_minutes=Math.round((Date.now()-e.start_time)/1e3/60),await c.postQuizResult(t.meta),U.success("考试提交成功!")},w=()=>{e.state=r.FINISHED};return M((s,l,t)=>{if(e.state!=r.ONGOING){t();return}Q.confirm("正在考试中，离开页面数据将会丢失，考试中断！","确认离开吗？",{confirmButtonText:"继续考试",cancelButtonText:"确认离开",type:"warning",closeOnPressEscape:!1,distinguishCancelAndClose:!0}).then(a=>{t(!1)}).catch(a=>{a=="cancel"?t():t(!1)})}),(s,l)=>{const t=A,a=F,b=P,h=z,g=$,I=H,N=G,x=C;return m(),f(x,null,{default:n(()=>[o(a,null,{default:n(()=>[u("span",null,"【"+i(e.name)+"】",1),o(L,{style:{color:"red"},start_flag:e.state==d(r).ONGOING,duration_secs:100,blink:!0,start_text:"【已用时间】",count_down:!1,onEnd_event:E},null,8,["start_flag"]),o(t,{link:"",type:"primary",disabled:e.state==d(r).FINISHED,onClick:w},{default:n(()=>[D("提交")]),_:1},8,["disabled"])]),_:1}),o(N,null,{default:n(()=>[o(I,{gutter:16,class:"q-body"},{default:n(()=>[(m(!0),S(q,null,V(e.meta,_=>(m(),f(g,{xs:24,sm:12,md:8,lg:6,xl:4},{default:n(()=>[o(h,null,{default:n(()=>[u("span",j,i(_.title),1),o(b,{modelValue:_.user_answer,"onUpdate:modelValue":y=>_.user_answer=y,max:999,clearable:"",type:"number",disabled:e.state==d(r).FINISHED},null,8,["modelValue","onUpdate:modelValue","disabled"]),u("span",null,i(_.mark),1)]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1})}}});const me=R(J,[["__scopeId","data-v-9146ab5f"]]);export{me as default};
