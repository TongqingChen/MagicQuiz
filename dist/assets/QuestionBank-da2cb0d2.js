import{d as F,e as U,A as $,r as w,j as h,h as G,o as g,m as B,b as r,p as i,a as z,f as _,w as c,F as E,s as D,c as T,t as y,ap as M,$ as H,E as J,_ as K}from"./index-497a94ff.js";import{Q as O}from"./QuestionDialog-851bb68a.js";import{E as P,a as W}from"./el-table-column-83f2b486.js";import"./el-tag-c8052f62.js";import{E as X,a as Y}from"./el-radio-group-20a1dd4d.js";/* empty css                        */import{Q as Z}from"./QuizCascader-f5648622.js";import{v as ee}from"./directive-b2d733fd.js";import"./el-image-viewer-3965d51d.js";import"./debounce-74e9c51d.js";import"./isEqual-0285f7e8.js";const te={class:"subject"},ie={class:"subject"},ae=F({__name:"QuestionBank",setup(le){U(async()=>{await $.getQuizList().then(n=>{n.data.forEach(t=>{if(t.subject!=3){var e={quiz:{id:t.id,name:t.name},subject:{id:t.subject,name:t.subject_name},grade:{id:t.grade,name:t.grade_name},volume:{id:t.volume,name:t.volume_name}};V.push(e);var s=d.findIndex(p=>p.v.id==e.subject.id);s<0&&(s=d.length,d.push({v:e.subject,children:[]}));var o=d[s].children.findIndex(p=>p.v.id==e.grade.id);o<0&&(o=d[s].children.length,d[s].children.push({v:e.grade,children:[]}));var b=d[s].children[o].children.findIndex(p=>p.id==e.volume.id);b<0&&(b=d[s].children[o].children.length,d[s].children[o].children.push(e.volume))}})})});const j=["全部","单选","判断","填空","问答"],N=["简单","一般","困难"];let d=w([]),V=w([]),m=h(0),v=w([]);const f=h(0);let x=w([]),Q=h(""),a=-1;const C=h(!1),k=h(!1),R=n=>{a=n,C.value=!0},u=G(()=>(a=-1,x.filter(n=>f.value<0||n.type==f.value))),A=(n,t,e)=>{Q.value=`【${n.name} | ${t.name} | ${e.name}】`,v.splice(0),v=V.filter(s=>s.subject.id==n.id&&s.grade.id==t.id&&s.volume.id==e.id),v.length>0&&(m.value=v[0].quiz.id,Q.value+=v[0].quiz.name,I())},I=()=>{k.value=!0,x.splice(0),$.getQuestionListByQuizId(m.value).then(n=>{var t=1;n.data.forEach(e=>{x.push({index:t++,id:e.id,type:e.type,title:e.title,description:e.description,image:e.image,analysis:e.analysis,difficulty_level:e.difficulty_level,score:e.score,answer:e.answer,is_favourited:e.is_favourited,wrong_times:e.wrong_times})}),f.value=-1,k.value=!1})},S=({row:n,rowIndex:t})=>t%2?"":"success-row";return(n,t)=>{const e=X,s=Y,o=P,b=J,p=W,q=ee;return g(),B(E,null,[r(Z,{options:i(d),onClicked:A},null,8,["options"]),z("div",te,[_(" 试卷： "),r(s,{modelValue:i(m),"onUpdate:modelValue":t[0]||(t[0]=l=>M(m)?m.value=l:m=l),size:"small",onChange:I},{default:c(()=>[(g(!0),B(E,null,D(i(v),l=>(g(),T(e,{label:l.quiz.id},{default:c(()=>[_(y(l.quiz.name),1)]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),z("div",ie,[_(" 题型： "),r(s,{modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=l=>f.value=l),size:"small"},{default:c(()=>[(g(),B(E,null,D(j,(l,L)=>r(e,{label:L-1},{default:c(()=>[_(y(l),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),H((g(),T(p,{data:u.value,style:{width:"100%","font-size":"12px"},"row-class-name":S,border:""},{default:c(()=>[r(o,{fixed:"",type:"index",width:"32px"}),r(o,{label:"题型",width:"40px"},{default:c(l=>[_(y(j[l.row.type+1]),1)]),_:1}),r(o,{prop:"title",label:"题目","show-overflow-tooltip":""}),r(o,{prop:"description",label:"描述","show-overflow-tooltip":""}),r(o,{label:"难度",width:"40px"},{default:c(l=>[_(y(N[l.row.difficulty_level]),1)]),_:1}),r(o,{fixed:"right",label:"查看",width:"40px"},{default:c(l=>[r(b,{link:"",type:"primary",size:"small",onClick:L=>R(l.$index)},{default:c(()=>[_("详情")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[q,k.value]]),r(O,{visible:C.value,wrong_times:i(a)>=0?u.value[i(a)].wrong_times:0,id:i(a)>=0?u.value[i(a)].id:0,is_favourited:i(a)>=0?u.value[i(a)].is_favourited:!1,header:i(a)>=0?`${u.value[i(a)].id}. ${i(Q)}`:"",title:i(a)>=0?u.value[i(a)].title:"",image:i(a)>=0?u.value[i(a)].image:"",description:i(a)>=0?u.value[i(a)].description:"",analysis:i(a)>=0?u.value[i(a)].analysis:"",answer:i(a)>=0?u.value[i(a)].answer:"",userAnswer:null,onClose:t[2]||(t[2]=l=>{u.value[i(a)].is_favourited=l,C.value=!1})},null,8,["visible","wrong_times","id","is_favourited","header","title","image","description","analysis","answer"])],64)}}});const fe=K(ae,[["__scopeId","data-v-462abf56"]]);export{fe as default};
