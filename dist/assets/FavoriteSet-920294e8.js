import{d as S,u as T,j as I,r as p,e as V,A as g,o as _,m as D,b as r,$ as A,p as a,c as h,w as u,f as b,t as Q,an as z,q as N,F as M,ao as w,k as R,E as L,i as G,_ as H}from"./index-89aeeb22.js";import{Q as J}from"./QuestionDialog-8cc71ff7.js";/* empty css                 */import{E as K,a as O}from"./el-table-column-00f217c6.js";import"./el-tag-a9b17241.js";import{Q as P}from"./QuizCascader-d036046c.js";import{E as U}from"./index-fb0fe262.js";import{v as W}from"./directive-1618ec9e.js";import"./el-image-viewer-854bb0ac.js";import"./debounce-883dd20d.js";import"./isEqual-61dcd27d.js";import"./el-radio-group-9f69f746.js";/* empty css                        */const X=S({__name:"FavoriteSet",setup(Y){const q=T();let x=I(!0);var f=p([]),v=p([]),t=p([]);const l=p([]),e=p({subject:{id:0,name:""},grade:{id:0,name:""},volume:{id:0,name:""},drawerVisible:!1,qidx:-1});V(()=>{g.getFavouriteSetsBySubInfos().then(s=>{f=s.data.quizs,f.forEach(n=>{var o=l.findIndex(c=>c.v.id==n.subject.id);o<0&&(o=l.length,l.push({v:n.subject,children:[]}));var d=l[o].children.findIndex(c=>c.v.id==n.grade.id);d<0&&(d=l[o].children.length,l[o].children.push({v:n.grade,children:[]}));var i=l[o].children[d].children.findIndex(c=>c.id==n.volume.id);i<0&&(i=l[o].children[d].children.length,l[o].children[d].children.push(n.volume))}),v=s.data.questions,x.value=!1})});const y=(s,n,o)=>{e.subject=s,e.grade=n,e.volume=o,x.value=!0,e.qidx=-1,t.splice(0);var d=f.filter(i=>i.subject.id==s.id&&i.grade.id==n.id&&i.volume.id==o.id);t=v.filter(i=>d.some(c=>c.quiz.id==i.qz_id)),x.value=!1},k=s=>{e.qidx=s,e.drawerVisible=!0},C=s=>{e.qidx=s,w.confirm(`从收藏集里删除本题【${t[e.qidx].title.substring(0,10)}...】吗？`,"请确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await g.deleteFavouriteQuestion(t[e.qidx].qid).then(async n=>{R({message:"删除成功.",type:"success"})})})},$=()=>{w.confirm(`开始【${e.subject.name}⭐${e.grade.name}⭐${e.volume.name}《收藏题集》】(60分钟)考试吗？`,"请确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{q.push({path:"/exam",query:{id:-3,name:"收藏题集",subject:e.subject.name,grade:e.grade.name,volume:e.volume.name,exam_seconds:60*60}})})},E=({row:s,rowIndex:n})=>n%2==0?"success-row":"";return(s,n)=>{const o=L,d=G,i=K,c=O,j=U,B=W;return _(),D(M,null,[r(P,{options:l,onClicked:y},null,8,["options"]),A((_(),h(c,{data:a(t),"row-class-name":E,border:"",style:{width:"100%",color:"darkslategray","font-size":"12px"}},{default:u(()=>[r(i,{fixed:"",lable:"序号",width:"32px",align:"center"},{default:u(m=>[r(d,{effect:"dark",content:"详情"},{default:u(()=>[r(o,{link:"",type:"primary",size:"small",onClick:F=>k(m.$index)},{default:u(()=>[b(Q(m.$index+1),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:1}),r(i,{prop:"qz_name",label:"试卷名",width:"88px",sortable:"","show-overflow-tooltip":"",align:"center"}),r(i,{prop:"type",label:"题型",width:"60px",sortable:"",align:"center"}),r(i,{prop:"title",label:"题目","show-overflow-tooltip":""}),r(i,{prop:"description",label:"描述","show-overflow-tooltip":""}),r(i,{prop:"level",label:"难度",width:"60px",sortable:"",align:"center"}),r(i,{fixed:"right",label:"删除",width:"40px"},{default:u(m=>[r(o,{link:"",type:"primary",size:"small",onClick:F=>C(m.$index)},{default:u(()=>[b("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[B,a(x)]]),a(t).length>0?(_(),h(j,{key:0,position:"bottom",offset:20},{default:u(()=>[r(d,{placement:"right",content:"收藏题考试"},{default:u(()=>[r(o,{type:"primary",icon:a(z),circle:"",onClick:$},null,8,["icon"])]),_:1})]),_:1})):N("",!0),r(J,{visible:e.drawerVisible,id:e.qidx>=0?a(t)[e.qidx].qid:0,wrong_times:e.qidx>=0?a(t)[e.qidx].wrong_times:0,is_favourited:e.qidx>=0?a(t)[e.qidx].is_favourited:!1,header:e.qidx>=0?`${a(t)[e.qidx].qid}.【${e.subject.name} | ${e.grade.name} | ${e.volume.name}】${a(t)[e.qidx].qz_name}`:"",title:e.qidx>=0?a(t)[e.qidx].title:"",image:e.qidx>=0?a(t)[e.qidx].image:"",description:e.qidx>=0?a(t)[e.qidx].description:"",analysis:e.qidx>=0?a(t)[e.qidx].analysis:"",answer:e.qidx>=0?a(t)[e.qidx].answer:"",userAnswer:e.qidx>=0?a(t)[e.qidx].user_answer:"",onClose:n[0]||(n[0]=m=>{a(t)[e.qidx].is_favourited=m,e.drawerVisible=!1})},null,8,["visible","id","wrong_times","is_favourited","header","title","image","description","analysis","answer","userAnswer"])],64)}}});const me=H(X,[["__scopeId","data-v-e363c1c2"]]);export{me as default};
